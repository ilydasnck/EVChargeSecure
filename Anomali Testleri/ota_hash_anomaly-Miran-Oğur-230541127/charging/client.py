<the original client.py content was large; it was copied verbatim into this file>